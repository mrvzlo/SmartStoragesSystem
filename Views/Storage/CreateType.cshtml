@model List<SmartKitchen.Models.StorageType>
@{
	int count = 0;
	ViewBag.Title = "Storage types";
}
<div class="row justify-content-between mt-4 mx-4">
	<h4>@ViewBag.Title</h4>
	@Html.ActionLink("Back", "Create", "Storage", new { @class = "btn btn-secondary" })
</div>

<div class="row">
	@foreach (var item in Model)
	{
		<div class="col-md-4 col-12">
			<div id="@count" class="storage-small row" style="background-color: #@item.Background" onclick='updateForm("@item.Name","@item.Background","@item.Icon");'>
				<div class="@item.Icon col-1"></div>
				<div class="col">@item.Name</div>
			</div>
		</div>
		count++;
	}
</div>

@using (Html.BeginForm("CreateType", "Storage", FormMethod.Post, new { @class = "row justify-content-center" }))
{
	@Html.AntiForgeryToken()
	<div class="col-md-6 storage" id="storage">
		<div class="row justify-content-center">
			<div class="col-md-1">Name</div>
			<div class="col-md-1"></div>
			<div class="col-md-9">@Html.Editor("Name")</div>
			<div class="error col-12">@Html.ValidationMessage("Name")</div>
			<div class="col-1">Icon</div>
			<div class="col-md-1 col-10"><span id="IconPre" style="height: 100%;"></span></div>
			<div class="col-md-9">@Html.Editor("Icon")</div>
			<div class="error col-12">@Html.ValidationMessage("Icon")</div>
			<div class="col-md-1">Color</div>
			<div class="col-md-1"></div>
			<div class="col-md-9">@Html.Editor("Background", $"ffffff", new { htmlAttributes = new { @class = "jscolor" } })</div>
			<div class="error col-12">@Html.ValidationMessage("Background")</div>
			<div class="text-center col-6"><input type="submit" value="Save" class="btn btn-main col-6" /></div>
		</div>
	</div>
}
@section scripts
{
	<script>
		$("#Icon").on('change', function () {
			$('#IconPre').removeClass();
			$("#IconPre").addClass("fa fa-" + $(this).val());
		});

		$("body").click(function () {
			$("#storage").css("background-color", "#" + $("#Background").val());
		});

		function updateForm(name, color, icon) {
			$("#Name").val(name);
			$("#Icon").val(icon.substring(6, icon.length)).change();
			document.getElementById("Background").jscolor.fromString(color);
		}
	</script>
}
