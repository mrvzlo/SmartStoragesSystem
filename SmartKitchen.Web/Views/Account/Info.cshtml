@{
    ViewBag.Title = "My account";
    var currencyList = new SelectList(ViewBag.CurrencyList, "Value", "Text", ViewBag.Currency);
    var weightList = new SelectList(ViewBag.WeightList, "Value", "Text", ViewBag.Weight);
}
<h5 class="text-center">This key can be used to connect your account to smart devices</h5>
<div class="row justify-content-center my-2">
    <textarea id="publicKey" class="col-md-6 col-10 input" readonly="readonly" rows="4">@ViewBag.PublicKey</textarea>
    <img class="rowicon" id="copyPublic" src="~/Content/icons/copy.png" />
</div>
<div class="row justify-content-center my-2">
    <button id="updToken" class="btn btn-main">Generate new keys</button>
</div>

<div class="row justify-content-center my-2">
    <div class="h5 col-12 text-center">Your identificator</div>
    <input class="col-md-2 col-3 text-center" readonly="readonly" value="@ViewBag.PersonId" />
</div>
<div class="row justify-content-center mt-4">
    <div class="h4 col-12 text-center m-0">Preferences</div>
    @using (Html.BeginForm("UpdateCookies", "Account", FormMethod.Post, new { @class = "col-lg-6 col-8" }))
    {
        <div class="row justify-content-center">
            <div class="col-md-6 text-center my-2">
                @Html.Label("Currency")
                @Html.DropDownList("currency", currencyList, new { @class = "input" })
            </div>
            <div class="col-md-6 text-center my-2">
                @Html.Label("Weight measurement")
                @Html.DropDownList("weight", weightList, new { @class = "input" })
            </div>
            <button type="submit" class="btn btn-main px-4">Save changes</button>
        </div>
    }
</div>

@section scripts{
    <script>
        $(function () {
            $(document).on("click", "#updToken", function() {
                var url = '@Url.Action("UpdateKeyPair","Account")';
                $.post(url,
                    function (data) {
                        $("#publicKey").text(data);
                    });
            });
            $(document).on("click", "#copyPublic", function () {
                document.getElementById("publicKey").select();
                document.execCommand("copy");
            });
        });
    </script>
}
